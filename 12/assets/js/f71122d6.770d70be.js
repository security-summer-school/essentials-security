"use strict";(self.webpackChunkessentials_security=self.webpackChunkessentials_security||[]).push([[430],{5680:(e,t,n)=>{n.d(t,{xA:()=>c,yg:()=>u});var a=n(6540);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var o=a.createContext({}),p=function(e){var t=a.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(o.Provider,{value:t},e.children)},y="mdxType",g={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,o=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),y=p(n),h=r,u=y["".concat(o,".").concat(h)]||y[h]||g[h]||i;return n?a.createElement(u,s(s({ref:t},c),{},{components:n})):a.createElement(u,s({ref:t},c))}));function u(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,s=new Array(i);s[0]=h;var l={};for(var o in t)hasOwnProperty.call(t,o)&&(l[o]=t[o]);l.originalType=e,l[y]="string"==typeof e?e:r,s[1]=l;for(var p=2;p<i;p++)s[p]=n[p];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},9786:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>s,default:()=>g,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var a=n(8168),r=(n(6540),n(5680));const i={},s="Web Attacks",l={unversionedId:"Demystifying the Web/Hacking the Web/Reading/web-attacks",id:"Demystifying the Web/Hacking the Web/Reading/web-attacks",title:"Web Attacks",description:"Path Traversal",source:"@site/docs/Demystifying the Web/Hacking the Web/Reading/web-attacks.md",sourceDirName:"Demystifying the Web/Hacking the Web/Reading",slug:"/Demystifying the Web/Hacking the Web/Reading/web-attacks",permalink:"/essentials-security/12/Demystifying the Web/Hacking the Web/Reading/web-attacks",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"sidebar",previous:{title:"HTTP Sessions",permalink:"/essentials-security/12/Demystifying the Web/Hacking the Web/Reading/sessions"},next:{title:"Summary",permalink:"/essentials-security/12/Demystifying the Web/Hacking the Web/Reading/summary"}},o={},p=[{value:"Path Traversal",id:"path-traversal",level:2},{value:"DIRectory Buster (DIRB)",id:"directory-buster-dirb",level:2}],c={toc:p},y="wrapper";function g(e){let{components:t,...n}=e;return(0,r.yg)(y,(0,a.A)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.yg)("h1",{id:"web-attacks"},"Web Attacks"),(0,r.yg)("h2",{id:"path-traversal"},"Path Traversal"),(0,r.yg)("p",null,"Every request asks for a file.\nRemember ",(0,r.yg)("inlineCode",{parentName:"p"},"GET /path/to/file"),".\nEven ",(0,r.yg)("inlineCode",{parentName:"p"},"GET /")," implicitly asks for ",(0,r.yg)("inlineCode",{parentName:"p"},"index.html")," or ",(0,r.yg)("inlineCode",{parentName:"p"},"index.php"),"."),(0,r.yg)("p",null,"If the application does not verify the parameter, an attacker might be able to exploit the application and display an arbitrary file from the target system.\nNormally an attacker would try to access sensitive files containing passwords or configurations in order to gain access to the system.\nRemember that PHP scripts aren't normally visible by the client."),(0,r.yg)("p",null,"Below is an example of a vulnerability where an attacker can leak PHP scripts:\nConsider the following URL:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-plaintext"},"http://somesite.com/view.php?file=image.jpg\n")),(0,r.yg)("p",null,"What if the attacker could query the website using ",(0,r.yg)("inlineCode",{parentName:"p"},"view.php")," as parameter?"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-plaintext"},"http://somesite.com/view.php?file=view.php\n")),(0,r.yg)("p",null,"This would be too easy.\nSometimes, images are stored in different directories than application files.\nSo our attacker should query the server like with a link like this one:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-plaintext"},"http://somesite.com/view.php?file=../../view.php\n")),(0,r.yg)("p",null,"If they manage to view ",(0,r.yg)("inlineCode",{parentName:"p"},"view.php"),", then it is likely they can access any file on the system, such as ",(0,r.yg)("inlineCode",{parentName:"p"},"/etc/passwd"),", using this query:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-plaintext"},"http://somesite.com/view.php?file=/etc/passwd\n")),(0,r.yg)("p",null,"This kind of situation when an attacker can freely access files on the server is called a ",(0,r.yg)("strong",{parentName:"p"},"path traversal attack"),".\nTo fix this, applications should always validate user input and ensure the path they request is within a safe folder to which they have access."),(0,r.yg)("h2",{id:"directory-buster-dirb"},"DIRectory Buster (DIRB)"),(0,r.yg)("p",null,"There may be other files stored on the server that aren't accessible from the entry point web page.\nIt is difficult to search for such pages manually.\nLuckily there are tools that can help us with this.\nOne of them is ",(0,r.yg)("strong",{parentName:"p"},"DIRectory Buster"),", or ",(0,r.yg)("inlineCode",{parentName:"p"},"dirb")," in short.\nIt simply queries a web server for many files ",(0,r.yg)("strong",{parentName:"p"},"fast"),".\nAll you need to do is to give it a list of files for which to search."),(0,r.yg)("p",null,"Here's how to run it:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-console"},"root@kali:~# dirb <URL> wordlist.txt\n")),(0,r.yg)("p",null,"A good starting point for wordlists are the lists ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/danielmiessler/SecLists/tree/master/Discovery/Web-Content"},"here"),", particularly those named ",(0,r.yg)("inlineCode",{parentName:"p"},"raft-large-*.txt"),":"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"raft-large-files.txt")," for files, duh..."),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("inlineCode",{parentName:"li"},"raft-large-directories.txt")," for directories")),(0,r.yg)("p",null,(0,r.yg)("inlineCode",{parentName:"p"},"dirb")," works by issuing lots of ",(0,r.yg)("inlineCode",{parentName:"p"},"GET")," requests, one for each file in its wordlist.\nIf a request receives a 404 response, the file doesn't exist.\nOtherwise, it does (except for 500 responses, in which case the request is resent).\nEven a 403 response is alright.\nIt just means that a regular user doesn't have access to that file."),(0,r.yg)("p",null,"Here's what ",(0,r.yg)("inlineCode",{parentName:"p"},"dirb")," + ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/danielmiessler/SecLists"},(0,r.yg)("inlineCode",{parentName:"a"},"SecLists"))," look like:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-console"},"root@kali:~# dirb http://example.com ~/SecLists/Discovery/Web-Content/raft-large-files.txt\n[...]\n---- Scanning URL: http://example.com/ ----\n+ http://example.com/index.html (CODE:200|SIZE:1256)\n+ http://example.com/. (CODE:200|SIZE:1256)\n+ http://example.com/extension.inc (CODE:403|SIZE:345)\n[...]\n")))}g.isMDXComponent=!0}}]);