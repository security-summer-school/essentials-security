<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Binary Introduction/Assembly Language/README">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Assembly Language | Essentials Security</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://localhost//essentials-security/Binary Introduction/Assembly Language/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Assembly Language | Essentials Security"><meta data-rh="true" name="description" content="Introduction"><meta data-rh="true" property="og:description" content="Introduction"><link data-rh="true" rel="canonical" href="http://localhost//essentials-security/Binary Introduction/Assembly Language/"><link data-rh="true" rel="alternate" href="http://localhost//essentials-security/Binary Introduction/Assembly Language/" hreflang="en"><link data-rh="true" rel="alternate" href="http://localhost//essentials-security/Binary Introduction/Assembly Language/" hreflang="x-default"><link rel="stylesheet" href="/essentials-security/assets/css/styles.a69a9d41.css">
<link rel="preload" href="/essentials-security/assets/js/runtime~main.3d084626.js" as="script">
<link rel="preload" href="/essentials-security/assets/js/main.1a32775d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/essentials-security/"><div class="navbar__logo"><img src="/essentials-security/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/essentials-security/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Essentials Security</b></a><a class="navbar__item navbar__link" href="/essentials-security/Scratch Linux">Scratch Linux</a><a class="navbar__item navbar__link" href="/essentials-security/Demystifying the Web">Demystifying the Web</a><a class="navbar__item navbar__link" href="/essentials-security/Data">Data</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/essentials-security/Binary Introduction">Binary Introduction</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/essentials-security/Scratch Linux/">Scratch Linux</a><button aria-label="Toggle the collapsible sidebar category &#x27;Scratch Linux&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/essentials-security/Demystifying the Web/">Demystifying the Web</a><button aria-label="Toggle the collapsible sidebar category &#x27;Demystifying the Web&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/essentials-security/Data/">Data</a><button aria-label="Toggle the collapsible sidebar category &#x27;Data&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/essentials-security/Binary Introduction/">Binary Introduction</a><button aria-label="Toggle the collapsible sidebar category &#x27;Binary Introduction&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/essentials-security/Binary Introduction/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/essentials-security/Binary Introduction/Application Lifetime/">Application Lifetime</a><button aria-label="Toggle the collapsible sidebar category &#x27;Application Lifetime&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/essentials-security/Binary Introduction/Binary Analysis/">Binary Analysis</a><button aria-label="Toggle the collapsible sidebar category &#x27;Binary Analysis&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--sublist menu__link--active" aria-current="page" aria-expanded="true" tabindex="0" href="/essentials-security/Binary Introduction/Assembly Language/">Assembly Language</a><button aria-label="Toggle the collapsible sidebar category &#x27;Assembly Language&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/essentials-security/Binary Introduction/Assembly Language/">Reading</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/essentials-security/Binary Introduction/Taming the Stack/">Taming the Stack</a><button aria-label="Toggle the collapsible sidebar category &#x27;Taming the Stack&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/essentials-security/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/essentials-security/Binary Introduction/"><span itemprop="name">Binary Introduction</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Assembly Language</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Assembly Language</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">​</a></h2><p>In the previous 2 sessions you started discovering what binary security looks like.
<a href="/essentials-security/Binary Introduction/binary-analysis/">Last session</a> you learnt two very powerful means of investigating and even reverse engineering executables: static and dynamic analysis.
In order to leverage them efficiently, you used Ghidra for static analysis.
Now we&#x27;ll introduce GDB for dynamic analysis.
You&#x27;ve most likely noticed that they are able to display the source code of the application.
GDB can do so when said app was compiled with <em>debug symbols</em>, while Ghidra does not even need debug symbols.
It infers the original C code from its compiled representation (learn more about how Ghidra does this by taking part in the <a href="https://security-summer-school.github.io/binary/static-analysis/#ida-and-ghidra" target="_blank" rel="noopener noreferrer">Binary Security track</a> next year).
This representation is called <strong>assembly language</strong>.
Both Ghidra and GDB can display the program&#x27;s code in assembly language.
Today we will demystify this low-level language and learn to understand it.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="reminders-and-prerequisites">Reminders and Prerequisites<a class="hash-link" href="#reminders-and-prerequisites" title="Direct link to heading">​</a></h2><p>For this session, you need:</p><ul><li>a working knowledge of the C programming language and familiarity with pointers</li><li>basic skills with Ghidra and GDB</li><li>understand how an executable file is created, as described in the <a href="/essentials-security/Binary Introduction/application-lifetime/">Application Lifetime session</a></li><li>knowledge of the following means of representing data: ASCII, binary, hexadecimal.</li></ul><p>Check out the session on <a href="/essentials-security/Binary Introduction/data-representation/">Data Representation</a> for a reminder.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="assembly">Assembly<a class="hash-link" href="#assembly" title="Direct link to heading">​</a></h2><p>Assembly is a low-level language used as a human-readable representation of instructions executed by the CPU.
There is a one-to-one mapping between the binary code executed by the CPU and Assembly.
Few people write Assembly, but many people are required to read it:</p><ul><li>security engineers</li><li>compiler / interpreter developers</li><li>embedded developers</li><li>operating systems developers</li></ul><p>Simply put, if a field is close to CPU it requires (some knowledge of) Assembly.
So let&#x27;s learn this language!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="registers">Registers<a class="hash-link" href="#registers" title="Direct link to heading">​</a></h2><p>You might have already seen the image below.
It shows the various places where data can be kept.
Note that this data can be both non-persistent and persistent.
Non-persistent data is gone once you shut down the computer.
It&#x27;s kept in all levels from &quot;Main Memory&quot; upwards.
The &quot;Main Memory&quot; is simply referred to as <strong>memory</strong> or RAM.</p><p>Persistent storage refers to data on <strong>disks</strong>: HDD, SSD, CDs, DVDs, magnetic tapes, even in the cloud (where cloud storage providers also use HDDs, SSDs etc.).
If you shut down your laptop or your mobile phone, your pictures or video games remain unchanged.
This is because they are stored <em>on your device&#x27;s disk</em>.
We simply refer to persistent storage as <strong>storage</strong>.
Take note of the difference between <em>storage</em> and <em>memory</em>.</p><p><img loading="lazy" alt="Memory Hierarchy" src="/essentials-security/assets/images/memory-hierarchy-4d4374f26fd02d44a54142b710c3c169.png" width="1567" height="1010" class="img_ev3q"></p><p>In most programming languages you can freely access data everywhere up to and including the memory.
In assembly however, you also have access to the <strong>registers</strong> and can influence the <strong>cache</strong>.
We won&#x27;t be dealing with the cache in this session, but you can read more about them <a href="#caches">at the end of this session</a>
They are the fastest form of memory available and are implemented <strong>inside the CPU</strong>.
We can access data in registers in less than 1 ns (nanoseconds), as opposed to a few dozen ns when fetching data from the RAM.</p><p>Then why not make more registers and only use them instead of RAM?
Registers are fast because they are few in number.
This allows them to be efficiently wired to the CPU&#x27;s Arithmetic and Logic Unit (ALU), which is responsible for executing basic operations, such as addition, subtraction, bitwise and, or, shifts etc.
The more registers, the more complex and the less efficient the logic.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="registers-in-an-x64-cpu">Registers in an X64 CPU<a class="hash-link" href="#registers-in-an-x64-cpu" title="Direct link to heading">​</a></h3><p>Registers are like variables with fixed names embedded in the CPU.
They can be assigned values that can be modified via instructions.
There are several types of registers inside a CPU.
All of them can be assigned data and that data can be modified using the assembly-level operations described <a href="#assembly-instructions">further in this session</a>.</p><p>All registers are <strong>64-bits</strong> wide.
So they each can store up to 8 bytes of data.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="rip"><code>rip</code><a class="hash-link" href="#rip" title="Direct link to heading">​</a></h4><p>We&#x27;ll start with a very special and illusive one: the <strong>instruction pointer</strong> - <code>rip</code>.
In <a href="/essentials-security/Binary Introduction/binary-analysis/">the previous session</a>, you learned that the code of any process is also in its memory.
In order to read and execute it, the CPU must &quot;follow&quot; it just like children follow text with their fingers.
The CPU does this using <code>rip</code>.
This register stores te <strong>address of the currently executed instruction</strong>.
We will never use this instruction per-se in instructions, but you will see and make use of it in GDB.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="general-purpose-registers">General Purpose Registers<a class="hash-link" href="#general-purpose-registers" title="Direct link to heading">​</a></h4><p>Then there are <strong>general purpose registers</strong>.
As their name implies, they are used to store <em>anything</em>: addresses, user input, function parameters, data read from files or from the web etc.
Some of them also have some special functions, especially regarding function calls:</p><ul><li><code>rax</code>: accumulator register</li><li><code>rbx</code>: base register</li><li><code>rcx</code>: counter register; used with the <a href="#loops"><code>loop</code></a> instruction</li><li><code>rdx</code>: data register</li><li><code>rdi</code>: destination register</li><li><code>Rsi</code>: source register</li><li><code>r8</code>, <code>r9</code> ... <code>r15</code>: regular registers</li></ul><p>Do not learn them by heart.
And also do not bother with their extra meanings.
We will make use of those only when specified.
Otherwise, treat them as simple variables.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="smaller-registers">Smaller Registers<a class="hash-link" href="#smaller-registers" title="Direct link to heading">​</a></h4><p>Sometimes you only need to access 32 or 16 or 8 bits out of a 64-bit register.
This is possible by slightly changing the name of the register like so:</p><table><thead><tr><th align="center">64 bits</th><th align="center">Lowe 32 bits</th><th align="center">Lower 16 bits</th><th align="center">High 8 bits</th><th align="center">Low 8 bits</th></tr></thead><tbody><tr><td align="center"><code>rax</code></td><td align="center"><code>eax</code></td><td align="center"><code>ax</code></td><td align="center"><code>ah</code></td><td align="center"><code>al</code></td></tr><tr><td align="center"><code>rdi</code></td><td align="center"><code>edi</code></td><td align="center"><code>di</code></td><td align="center">unaccessible</td><td align="center"><code>dil</code></td></tr><tr><td align="center"><code>r8</code></td><td align="center"><code>r8d</code></td><td align="center"><code>r8w</code></td><td align="center">unaccessible</td><td align="center"><code>r8l</code></td></tr></tbody></table><p>The bits contained in each of the above subdivisions are shown in the image below.
It is similar for <code>rdi</code> and <code>r8</code>, it&#x27;s just the names that differ.</p><p><img loading="lazy" alt="rax Subdivisions" src="/essentials-security/assets/images/rax-subdivisions-30bbbba21a1b4eda4afd00d37e4ed801.svg" class="img_ev3q"></p><p><code>rbx</code>, <code>rcx</code> and <code>rdx</code> have the same subdivisions as <code>rax</code>.
<code>rsi</code> has the same subdivision as <code>rdi</code>: <code>esi</code>, <code>si</code> and <code>sil</code>.
It doesn&#x27;t make sense to access 4 bytes of an address.
The lower 2 bytes can be accessed due to historical reasons.
In the 70s, when the first CPU of this family (8086) was launched, it only supported 2-byte addresses.
All registers <code>r9</code> to <code>r15</code> have the same subdivisions as <code>r8</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="assembly-instructions">Assembly Instructions<a class="hash-link" href="#assembly-instructions" title="Direct link to heading">​</a></h2><p>We&#x27;ve now learned what assembly is theoretically and what registers are, but how do we use them?
Each CPU exposes an <strong>ISA (Instruction Set Architecture)</strong>: a set of instructions with which to modify and interact with its registers and with the RAM.
There are over 1000 instructions in the x64 ISA.
There are even instructions for efficiently encrypting data.
Find out more about them by enrolling in the <a href="https://github.com/security-summer-school/hardware-sec/" target="_blank" rel="noopener noreferrer">Hardware Assisted Security track</a>.</p><p>Before we dive into the instructions themselves, it&#x27;s useful to first look at their generic syntax:</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">instruction_name destination, source</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Most Assembly instructions have 2 operands: a source and a destination.
For some operations, such as arithmetic, the destination is also an operand.
The result of each instruction is always stored in the destination.</p><p>Below we&#x27;ll list some fundamental instructions.
We will be using the Intel Assembly syntax.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mov"><code>mov</code><a class="hash-link" href="#mov" title="Direct link to heading">​</a></h3><p><code>mov</code> is the most basic instruction in Assembly.
It <em>copies</em> (or <em>moves</em>) data from the source to the destination.
Also note that comments in Assembly are preceded by <code>;</code> and that the language is case-insensitive.</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mov eax, 3              ; eax = 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov rbx, &quot;SSS Rulz&quot;     ; place the string &quot;SSS Rulz&quot; in `rbx`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; This places each byte of the string &quot;SSS Rulz&quot; in rbx.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov r8b, bh             ; r8b = bh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; The sizes of the operands must be equal (1 byte each in this case).</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-manipulation">Data Manipulation<a class="hash-link" href="#data-manipulation" title="Direct link to heading">​</a></h3><p>Now that we&#x27;ve learnt how to place data in registers we need to learn how to do math with it.
As you&#x27;ve seen so far, Assembly instructions are really simple.
Below is a table with the most common and useful arithmetic instructions.
Try to figure out what each example does.
Use the fact that the general anatomy of an instruction is usually <code>instruction destination, source</code>.
The result is always stored in the <code>destination</code></p><table><thead><tr><th align="center">Instruction</th><th align="center">Description</th><th align="center">Examples</th></tr></thead><tbody><tr><td align="center"><code>add &lt;dest&gt;, &lt;src&gt;</code></td><td align="center"><code>dest += src</code></td><td align="center"><code>add rbx, 5</code><br><code>add r11, 0x99</code></td></tr><tr><td align="center"><code>sub &lt;dest&gt;, &lt;src&gt;</code></td><td align="center"><code>dest -= src</code></td><td align="center"><code>sub ecx, &#x27;a&#x27;</code><br><code>sub r9, r8</code></td></tr><tr><td align="center"><code>shl &lt;dest&gt;, &lt;bits&gt;</code></td><td align="center"><code>dest &lt;&lt;= bits</code></td><td align="center"><code>shl rax, 3</code><br><code>shl rdi, cl</code></td></tr><tr><td align="center"><code>shr &lt;dest&gt;, &lt;bits&gt;</code></td><td align="center"><code>dest &gt;&gt;= bits</code></td><td align="center"><code>shr r15, 5</code><br><code>shr rsi, cl</code></td></tr><tr><td align="center"><code>and &lt;dest&gt; &lt;src&gt;</code></td><td align="center"><code>dest &amp;= src</code></td><td align="center"><code>and al, ah</code><br><code>and bx, 13</code></td></tr><tr><td align="center"><code>or &lt;dest&gt; &lt;src&gt;</code></td><td align="center"><code>dest \|= src</code></td><td align="center"><code>or r10b, cl</code><br><code>or r14, 0x2000</code></td></tr><tr><td align="center"><code>xor &lt;dest&gt; &lt;src&gt;</code></td><td align="center"><code>dest ^= src</code></td><td align="center"><code>xor ebx, edx</code><br><code>xor rcx, 1</code></td></tr><tr><td align="center"><code>inc &lt;dest&gt;</code></td><td align="center"><code>dest++</code></td><td align="center"><code>inc rsi</code></td></tr><tr><td align="center"><code>dec &lt;dest&gt;</code></td><td align="center"><code>dest--</code></td><td align="center"><code>dec r10w</code></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="control-flow">Control Flow<a class="hash-link" href="#control-flow" title="Direct link to heading">​</a></h3><p>Now we know how to do maths and move bits around.
This is all good, but we still can&#x27;t write full programs.
We need a mechanism similar to <code>if</code>s from Python and also loops in order to make the code run based on conditions.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="jmp"><code>jmp</code><a class="hash-link" href="#jmp" title="Direct link to heading">​</a></h4><p>The simplest instruction for control flow is the <code>jmp</code> instruction.
It simply loads an address into the <code>rip</code> register.
But when Assembly code is generated or written either by the compiler or by us, instructions don&#x27;t have addresses yet.
These addresses are assigned during the <strong>linking</strong> or <strong>loading</strong> phase, as you know from the <a href="/essentials-security/Binary Introduction/application-lifetime/">Application Lifetime session</a>.</p><p>For this reason, we use <strong>labels</strong> as some sort of anchors.
We <code>jmp</code> to them and then the assembler will replace them with relative addresses which are then replaced with full addresses during linking.
The way in which <code>jmp</code> and labels function is very simple.
Remember that in the absence of <code>jmp</code>s, Assembly code is executed linearly just like a script.</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    jmp skip_next_section</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ; Whatever code is here is never executed.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">skip_next_section:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ; Only the code below this label is executed.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p><strong>Warning</strong>
Do not confuse labels with functions.
A label does not stop the execution of code when it&#x27;s reached.
They are simply ignored by anything except for <code>jmp</code>.</p></blockquote><p>For example, kin the the following code, both instructions are executed in the absence of <code>jmp</code>s:</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    mov rax, 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">some_label:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mov rbx, 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ; rax = 2; rbx = 3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="eflags"><code>eflags</code><a class="hash-link" href="#eflags" title="Direct link to heading">​</a></h4><p>Each instruction (except for <code>mov</code>) changes the <strong>inner state of the CPU</strong>.
In other words, several aspects regarding the result of the instruction are stored in a special register that we cannot access directly, called <code>eflags</code>.
There are <a href="https://stackoverflow.com/questions/1406783/how-to-read-and-write-x86-flags-registers-directly" target="_blank" rel="noopener noreferrer">instructions</a> that can set or clear some flags in <code>eflags</code>, but we cannot write something like <code>mov eflags, 2</code>.</p><p>As its name implies, each bit in <code>eflags</code> is a flag that is activated (i.e. set to 1) if a certain condition is true about the result of the last executed instruction.
We won&#x27;t be using these flags per se with one exception: <code>ZF</code> - the <strong>zero flag</strong>.
When active, it means that the result of the last instruction was... 0, duh!
This is useful for testing if numbers are equal for example.
We&#x27;ll talk about this in the next section.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="conditional-jumps">Conditional jumps<a class="hash-link" href="#conditional-jumps" title="Direct link to heading">​</a></h4><p>Now we know that there is an internal state of the CPU which is modified by each instruction, except for <code>mov</code>.
We still need a way to leverage this state.
We can do this via <strong>conditional jumps</strong>.</p><p>They are like <code>jmp</code> instructions, but the jump is made only when certain conditions are met.
Otherwise, code execution continues from the next instruction.
The general syntax of a conditional jump is</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">j[n]&lt;cond&gt; label</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>where the letter <code>n</code> is optional and means the jump will be made if the condition is <strong>not</strong> met.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="cmp-and-test"><code>cmp</code> and <code>test</code><a class="hash-link" href="#cmp-and-test" title="Direct link to heading">​</a></h5><p>We can use the regular arithmetic instructions that we&#x27;ve learned so far to modify <code>eflags</code>.
But this has the drawback of also modifying our data.
It would be great if we had a means to modify <code>eflags</code> without changing the data that we evaluate.
We can do this using <code>cmp</code> and <code>test</code>.</p><p><code>cmp dest, src</code> modifies <code>eflags</code> as if you were <strong>subtracting</strong> <code>src</code> from <code>dst</code>, but without modifying <code>dst</code>.
This is great for testing if 2 things are equal, or for testing which is greater or lower.</p><p><code>test dest, src</code> is similar to <code>cmp</code>, but modifies <code>eflags</code> according to the <code>and</code> instruction.
This comes in handy when we want to check if a register is 0.</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">test rax, rax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jz rax_is_zero</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>is equivalent to</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cmp rax, 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jz rax_is_zero</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now let&#x27;s have a look at some conditional jumps:</p><table><thead><tr><th align="center">Conditional jump</th><th align="center">Meaning</th></tr></thead><tbody><tr><td align="center"><code>jz</code> / <code>je</code></td><td align="center">Jump if the Zero Flag is active</td></tr><tr><td align="center"><code>jnz</code> / <code>jne</code></td><td align="center">Jump if the Zero Flag is not active</td></tr><tr><td align="center"><code>cmp rax, rbx</code><br><code>j[n]g</code></td><td align="center">Jump if <code>rax</code> is (not) greater (signed) than <code>rbx</code></td></tr><tr><td align="center"><code>cmp rax, rbx</code><br><code>j[n]a</code></td><td align="center">Jump if <code>rax</code> is (not) greater (unsigned) than <code>rbx</code></td></tr><tr><td align="center"><code>cmp rax, rbx</code><br><code>j[n]ge</code></td><td align="center">Jump if <code>rax</code> is (not) greater (signed) or equal than <code>rbx</code></td></tr><tr><td align="center"><code>cmp rax, rbx</code><br><code>j[n]ae</code></td><td align="center">Jump if <code>rax</code> is (not) greater (unsigned) or equal than <code>rbx</code></td></tr><tr><td align="center"><code>cmp rax, rbx</code><br><code>j[n]l</code></td><td align="center">Jump if <code>rax</code> is (not) lower (signed) than <code>rbx</code></td></tr><tr><td align="center"><code>cmp rax, rbx</code><br><code>j[n]b</code></td><td align="center">Jump if <code>rax</code> is (not) lower (unsigned) than <code>rbx</code></td></tr><tr><td align="center"><code>cmp rax, rbx</code><br><code>j[n]le</code></td><td align="center">Jump if <code>rax</code> is (not) lower (signed) or equal than <code>rbx</code></td></tr><tr><td align="center"><code>cmp rax, rbx</code><br><code>j[n]be</code></td><td align="center">Jump if <code>rax</code> is (not) lower (unsigned) or equal than <code>rbx</code></td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="loops">Loops<a class="hash-link" href="#loops" title="Direct link to heading">​</a></h4><p>We can create loops simply by combining labels and conditional jumps.
For example, <code>for i in range(0, 10)</code> from Python is equivalent to:</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    xor rcx, rcx    ; i = rcx; same as mov rcx, 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for_loop:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cmp rcx, 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    je done_loop    ; verify i &lt; 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ; The body of the for loop.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inc rcx         ; rcx++</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    jmp for_loop    ; re-evaluate the condition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">done_loop:</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Or alternatively, we can verify <code>rcx &lt; 10</code> at the end of the loop:</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    xor rcx, rcx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for_loop:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ; The body of the for loop.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inc rcx         ; rcx++</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cmp rcx, 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    jb for_loop    ; verify i &lt; 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ; The code here is executed only after the loop ends.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="dereferencing-addresses">Dereferencing Addresses<a class="hash-link" href="#dereferencing-addresses" title="Direct link to heading">​</a></h2><p>Up to this point we know how to operate with data and can write complex programs using conditional jumps.
But we know that data is stored mostly in the RAM.
How do we fetch it from there to our registers?</p><p>Imagine the RAM is one giant array.
Each byte is a cell in this array.
Therefore, each byte is found at a given <strong>index</strong> in this array.
Indices start at 0, so the first byte is found at index 0, the third 3 at index 2 and so on.
These indices are also called <strong>memory addresses</strong>, or simply <strong>addresses</strong>.</p><p>In order to load data from the RAM into our registers or vice-versa, we need to specify the CPU which RAM address to access.
This is called <strong>dereferencing that address</strong>.
Syntactically, this is very easy and is done by wrapping the address in <code>[]</code>.
The address can be either a raw number, or a register, or an expression:</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mov rax, [0xdeadbeef]   ; load 8 bytes from the address 0xdeadbeef into rax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov bx, [0xdeadbeef]    ; load 2 bytes from the address 0xdeadbeef into bx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov [0xdeadbeef], ecx   ; store 4 bytes from ecx at the address 0xdeadbeef</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Notice that the number of bytes that are transferred between the RAM and registers is given by the size of the register.
But what happens when we don&#x27;t use a register?
The code below is incorrect because it is impossible to tell how many bytes to use to write 0x69.
We could write it using one byte of course, but what if we wanted to write it on 4 bytes and store <code>[ 0x00 | 0x00 | 0x00 | 0x69 ]</code>?
To eliminate such ambiguities, we must specify the number of bytes that we want to write to the RAM:</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mov [0xdeadbeef], byte 0x2      ; writes 1 byte</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov [0xdeadbeef], word 0x2      ; writes 2 bytes: 0x00 and 0x02</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov [0xdeadbeef], dword 0x2     ; writes 4 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov [0xdeadbeef], qword 0x2     ; writes 8 bytes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Instead of a hardcoded value, we can express addresses as complex expressions which the CPU computes for us.
In the snippet below, the CPU computes the address given by <code>rdi + rcx * 4</code> and then writes the contents of <code>edx</code> there.</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mov [rdi + rcx * 4], edx</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This is equivalent to <code>v[i] = something</code> where <code>v</code> is an array of 4-byte values (hence <code>rcx * 4</code>):</p><ul><li><code>rdi</code> = starting address of <code>v</code></li><li><code>rcx</code> = <code>i</code></li><li><code>edx</code> = <code>something</code></li></ul><p>Therefore, whenever you see <code>[...]</code> in Assembly, what between the square brackets is being dereferenced <a href="#lea"><strong>with one exception</strong></a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="endianness">Endianness<a class="hash-link" href="#endianness" title="Direct link to heading">​</a></h3><p>This is all nice, but how does all this look like in the memory?
The order in which the bytes are stored in the RAM is called <strong>endianness</strong>.
Most CPUs store bytes <strong>in reverse order</strong>, or <strong>little endian</strong> order, because the least significant byte is the first.
When data is fetched back from the ram, the order is reversed:</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mov [0x100], dword 0x12345678       ; the RAM at 0x100: [ 0x78 | 0x56 | 0x34 | 0x12 ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov ax, [0x100]     ; ax = 0x5678</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov bx, [101]       ; bx = 0x3456</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>However, endianness does not apply to strings.
The code below writes the string <code>SSS Rulz</code> at the address 0x100.
Notice we don&#x27;t have to write it in reverse order like <code>zluR SSS</code>.</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mov rax, &quot;SSS Rulz&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov [0x100], rax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; We need to use a register because mov cannot take both an address and a 64-bit immediate as operands.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; https://www.felixcloutier.com/x86/mov</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="reading-assembly">Reading Assembly<a class="hash-link" href="#reading-assembly" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="objdump"><code>objdump</code><a class="hash-link" href="#objdump" title="Direct link to heading">​</a></h3><p>Starting from an executable file, we can read its Assembly code by <strong>disassembling</strong> it.
The standard tool for doing this is <code>objdump</code>:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@kali:~$ objdump -M intel -d &lt;binary&gt; | less</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>Use <code>-M intel</code> for Intel syntax.
The default syntax is AT&amp;T.</li><li><code>-d</code> stands for &quot;disassembly&quot;.</li><li>pipe the output to <code>less</code> so you can navigate the Assembly code more easily.</li></ul><p>Notice that every line contains an address, an opcode and an instruction.
The opcode is simply the binary representation of that instruction.</p><p>Alternatively, you can use GDB and Ghidra that you learned about <a href="/essentials-security/Binary Introduction/binary-analysis/">in the previous session</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="gdb">GDB<a class="hash-link" href="#gdb" title="Direct link to heading">​</a></h3><p>The undisputed king of Assembly is by far the <strong>GNU DeBugger (GDB)</strong>.
It&#x27;s just what its name says it is, but its beauty is in its versatility.
GDB is a command-line debugger that allows us to print registers, variables, dump memory from any address, step through the code, go back through the call stack and much more.
Today we will only get a glimpse of its power.</p><p>We are using the <code>pwndbg</code> extension for GDB as it allows us to view the assembly code, stack (you&#x27;ll learn about it in the <a href="/essentials-security/Binary Introduction/taming-the-stack/">next session</a>) and registers.
Follow the instructions <a href="https://github.com/pwndbg/pwndbg#how" target="_blank" rel="noopener noreferrer">here</a> to install it if you haven&#x27;t done so already.</p><p>GDB can run Assembly instructions one by one and stops after each instruction.
The current instruction is also clearly displayed.
Below is a reduced list of useful GDB commands to get you going.
Use it as a cheatsheet when you get stuck:</p><ul><li><p><code>start</code> = start running the program from <code>main</code></p></li><li><p><code>list</code> = decompile and display C code
Only works for executables compiled with <code>-g</code></p></li><li><p><code>pdis</code> = disassemble and display instructions with nice syntax highlighting</p></li><li><p><code>next</code> / <code>n</code> = run the current C code
If it is a function call, it is executed without stepping into the function.</p></li><li><p><code>nexti</code> / <code>ni</code> = run the current Assembly instruction</p></li><li><p><code>step</code> / <code>s</code> = if the debugger has reached a function call, step into it.
Otherwise, it behaves like <code>next</code> / <code>n</code></p></li><li><p><code>stepi</code> / <code>si</code> = step into function (used for the <code>call</code> instruction in Assembly)</p></li><li><p><code>break</code> / <code>b &lt;n&gt;</code> = place a breakpoint at line <code>n</code></p></li><li><p><code>break</code> / <code>b *&lt;address&gt;</code> = place breakpoint at address</p></li><li><p><code>continue</code> / <code>c</code> = run code until next breakpoint</p></li><li><p><code>info registers &lt;name&gt;</code> = display the values in all registers.
If a name is specified, only the value in that register is displayed</p></li><li><p><code>p &lt;variable&gt;</code> / <code>&lt;name&gt;</code> = print the variable / number; similar to <code>printf</code></p></li></ul><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">p/d = printf(&quot;%d&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p/c = printf(&quot;%c&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p/x = printf(“%x”)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">p/u = printf(“%u”)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>x &lt;address&gt;</code> = print data at the address (dereference it).
By default, the output is represented in hex</li><li><code>x/&lt;n&gt;&lt;d&gt;&lt;f&gt; &lt;address&gt;</code> -&gt; print <code>n</code> memory areas of size <code>d</code> with format <code>f</code>:</li></ul><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">n = any number; default = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d = b (byte - default) / h (half-word = short) / w (word = int) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">f = (like p): x (hex - default)  / c (char) / d (int, decimal) / u (unsigned)  / s (string)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Examples:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">x/20wx = 20 hex words (ints)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x/10hd = 10 decimal half-words (shorts)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x/10c = 10 ASCII characters</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x/10b = 10 hex bytes (because x is the default)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>set $&lt;register&gt; &lt;value&gt;</code> = sets the register to that value</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a class="hash-link" href="#summary" title="Direct link to heading">​</a></h2><p>The key takeaways from this session are:</p><ul><li>Assembly is a human-readable representation of instructions executed by the CPU</li><li>It allows us to access CPU registers directly</li><li>It uses a fixed set of instructions called ISA</li><li><strong>Memory</strong> is the RAM, <strong>storage</strong> is the disk</li><li>Data is stored in memory using the little endian representation</li><li>You can disassemble a program with <code>objdump</code> like so:</li></ul><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@kali:~$ objdump -M intel -d &lt;program&gt; |less</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="activities">Activities<a class="hash-link" href="#activities" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="in-plain-assembly">In Plain Assembly<a class="hash-link" href="#in-plain-assembly" title="Direct link to heading">​</a></h3><p>The flag is almost right there in your face.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="gotta-link-em-all">Gotta Link Em All<a class="hash-link" href="#gotta-link-em-all" title="Direct link to heading">​</a></h3><p>I wonder what hides in all those object files...</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="jump-maze">Jump Maze<a class="hash-link" href="#jump-maze" title="Direct link to heading">​</a></h3><p>Theseus has nothing on you!
Navigate the maze and get the flag.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="crypto">Crypto<a class="hash-link" href="#crypto" title="Direct link to heading">​</a></h3><p>Is it really about crypto?</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="call-me-little-sunshine">Call Me Little Sunshine<a class="hash-link" href="#call-me-little-sunshine" title="Direct link to heading">​</a></h3><p>Do what the binary asks you to do.
What, it doesn&#x27;t work?</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="further-reading">Further Reading<a class="hash-link" href="#further-reading" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-whole-isa">The Whole ISA<a class="hash-link" href="#the-whole-isa" title="Direct link to heading">​</a></h3><p>If you want to search for an instruction, use <a href="https://www.felixcloutier.com/x86/" target="_blank" rel="noopener noreferrer">this</a> website.
Each instruction has its own table with all possible operands and what they do.
Note that <code>imm8</code> means &quot;8-bit immediate&quot; (an 8-byte regular number), <code>imm64</code> means a 64-bit immediate and so on.
Similarly, <code>reg32</code> means a 32-bit register and <code>m16</code> for example means a 16-bit (2-byte) memory area.
You&#x27;ll see <code>reg</code>, <code>imm</code> and <code>m</code> combined with <code>8</code>, <code>16</code>, <code>32</code> and <code>64</code> depending on what each instruction does.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="caches">Caches<a class="hash-link" href="#caches" title="Direct link to heading">​</a></h3><p>Many programs access the same addresses repeatedly over a short period of time.
Take a short 1000-step loop.
It uses the same code 1000 times.
It would be inefficient for the CPU to read the instructions directly from the RAM 1000 times.
For this reason, there is an intermediary level of memory between the RAM and the registers, called <strong>the cache</strong>.</p><p>As their name implies, caches store the contents of some memory addresses that are frequently requested by the CPU.
We say <em>caches</em>, in plural because they are laid out hierarchically, each lower level being faster and smaller than the ones below.
Usually, CPUs have 3 levels of cache memory.
You can query their sizes with the <code>lscpu</code> command:</p><div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@kali:~$ lscpu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[...]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L1d cache:                       128 KiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L1i cache:                       128 KiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L2 cache:                        1 MiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L3 cache:                        6 MiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[...]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Notice the L1 (level 1) cache is split between a data cache (<code>L1d</code>) and an instruction cache <code>L1i</code>.
The other caches do not store data and instructions separately.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="assembly-syntaxes">Assembly Syntaxes<a class="hash-link" href="#assembly-syntaxes" title="Direct link to heading">​</a></h3><p>This session we&#x27;ve used the Intel syntax for writing and displaying Assembly.
We did so because it&#x27;s more straightforward than its alternative: the AT&amp;T syntax.
You can find the differences on <a href="https://en.wikipedia.org/wiki/X86_assembly_language#Syntax" target="_blank" rel="noopener noreferrer">Wikipedia</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="lea"><code>lea</code><a class="hash-link" href="#lea" title="Direct link to heading">​</a></h3><p><code>lea</code> stands for &quot;Load Effective Address&quot;.
Its syntax is:</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">lea dest, [address]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It loads <code>address</code> into the <code>dest</code> register (it can only be a register).
What&#x27;s interesting about it is that it also uses the <code>[...]</code> syntax, but <strong>does not dereference the address</strong>.
In the snippet below, <code>0xdeadbeef</code> is simply copied to <code>rax</code>.</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">lea rax, [0xdeadbeef]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Its true power comes from the fact that it can also compute an address.
For example, the code below will first compute the address given by <code>rdi + rcx * 8 + 7</code> and then write this address into <code>rax</code>.</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">lea rax, [rdi + rcx * 8 + 7]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/essentials-security/Binary Introduction/Assembly Language/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Assembly Language</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/essentials-security/Binary Introduction/Taming the Stack/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Taming the Stack</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#reminders-and-prerequisites" class="table-of-contents__link toc-highlight">Reminders and Prerequisites</a></li><li><a href="#assembly" class="table-of-contents__link toc-highlight">Assembly</a></li><li><a href="#registers" class="table-of-contents__link toc-highlight">Registers</a><ul><li><a href="#registers-in-an-x64-cpu" class="table-of-contents__link toc-highlight">Registers in an X64 CPU</a></li></ul></li><li><a href="#assembly-instructions" class="table-of-contents__link toc-highlight">Assembly Instructions</a><ul><li><a href="#mov" class="table-of-contents__link toc-highlight"><code>mov</code></a></li><li><a href="#data-manipulation" class="table-of-contents__link toc-highlight">Data Manipulation</a></li><li><a href="#control-flow" class="table-of-contents__link toc-highlight">Control Flow</a></li></ul></li><li><a href="#dereferencing-addresses" class="table-of-contents__link toc-highlight">Dereferencing Addresses</a><ul><li><a href="#endianness" class="table-of-contents__link toc-highlight">Endianness</a></li></ul></li><li><a href="#reading-assembly" class="table-of-contents__link toc-highlight">Reading Assembly</a><ul><li><a href="#objdump" class="table-of-contents__link toc-highlight"><code>objdump</code></a></li><li><a href="#gdb" class="table-of-contents__link toc-highlight">GDB</a></li></ul></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li><li><a href="#activities" class="table-of-contents__link toc-highlight">Activities</a><ul><li><a href="#in-plain-assembly" class="table-of-contents__link toc-highlight">In Plain Assembly</a></li><li><a href="#gotta-link-em-all" class="table-of-contents__link toc-highlight">Gotta Link Em All</a></li><li><a href="#jump-maze" class="table-of-contents__link toc-highlight">Jump Maze</a></li><li><a href="#crypto" class="table-of-contents__link toc-highlight">Crypto</a></li><li><a href="#call-me-little-sunshine" class="table-of-contents__link toc-highlight">Call Me Little Sunshine</a></li></ul></li><li><a href="#further-reading" class="table-of-contents__link toc-highlight">Further Reading</a><ul><li><a href="#the-whole-isa" class="table-of-contents__link toc-highlight">The Whole ISA</a></li><li><a href="#caches" class="table-of-contents__link toc-highlight">Caches</a></li><li><a href="#assembly-syntaxes" class="table-of-contents__link toc-highlight">Assembly Syntaxes</a></li><li><a href="#lea" class="table-of-contents__link toc-highlight"><code>lea</code></a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://security.cs.pub.ro/summer-school/wiki/" target="_blank" rel="noopener noreferrer" class="footer__link-item">OCW<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.facebook.com/SSSUPB/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 SSS Team</div></div></div></footer></div>
<script src="/essentials-security/assets/js/runtime~main.3d084626.js"></script>
<script src="/essentials-security/assets/js/main.1a32775d.js"></script>
</body>
</html>