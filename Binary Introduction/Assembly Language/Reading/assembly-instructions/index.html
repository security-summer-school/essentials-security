<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Binary Introduction/Assembly Language/Reading/assembly-instructions">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Assembly Instructions | Essentials Security</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://localhost//essentials-security/Binary Introduction/Assembly Language/Reading/assembly-instructions"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Assembly Instructions | Essentials Security"><meta data-rh="true" name="description" content="We&#x27;ve now learned what assembly is theoretically and what registers are, but how do we use them?"><meta data-rh="true" property="og:description" content="We&#x27;ve now learned what assembly is theoretically and what registers are, but how do we use them?"><link data-rh="true" rel="canonical" href="http://localhost//essentials-security/Binary Introduction/Assembly Language/Reading/assembly-instructions"><link data-rh="true" rel="alternate" href="http://localhost//essentials-security/Binary Introduction/Assembly Language/Reading/assembly-instructions" hreflang="en"><link data-rh="true" rel="alternate" href="http://localhost//essentials-security/Binary Introduction/Assembly Language/Reading/assembly-instructions" hreflang="x-default"><link rel="stylesheet" href="/essentials-security/assets/css/styles.a69a9d41.css">
<link rel="preload" href="/essentials-security/assets/js/runtime~main.6243ae71.js" as="script">
<link rel="preload" href="/essentials-security/assets/js/main.26f79083.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/essentials-security/"><div class="navbar__logo"><img src="/essentials-security/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/essentials-security/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Essentials Security</b></a><a class="navbar__item navbar__link" href="/essentials-security/Scratch Linux">Scratch Linux</a><a class="navbar__item navbar__link" href="/essentials-security/Demystifying the Web">Demystifying the Web</a><a class="navbar__item navbar__link" href="/essentials-security/Data">Data</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/essentials-security/Binary Introduction">Binary Introduction</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/essentials-security/Scratch Linux/">Scratch Linux</a><button aria-label="Toggle the collapsible sidebar category &#x27;Scratch Linux&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/essentials-security/Demystifying the Web/">Demystifying the Web</a><button aria-label="Toggle the collapsible sidebar category &#x27;Demystifying the Web&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/essentials-security/Data/">Data</a><button aria-label="Toggle the collapsible sidebar category &#x27;Data&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/essentials-security/Binary Introduction/">Binary Introduction</a><button aria-label="Toggle the collapsible sidebar category &#x27;Binary Introduction&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/essentials-security/Binary Introduction/Application Lifetime/">Application Lifetime</a><button aria-label="Toggle the collapsible sidebar category &#x27;Application Lifetime&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/essentials-security/Binary Introduction/Binary Analysis/">Binary Analysis</a><button aria-label="Toggle the collapsible sidebar category &#x27;Binary Analysis&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/essentials-security/Binary Introduction/Assembly Language/">Assembly Language</a><button aria-label="Toggle the collapsible sidebar category &#x27;Assembly Language&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/essentials-security/Binary Introduction/Assembly Language/Reading/">Reading</a><button aria-label="Toggle the collapsible sidebar category &#x27;Reading&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/essentials-security/Binary Introduction/Assembly Language/Reading/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/essentials-security/Binary Introduction/Assembly Language/Reading/registers">Registers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/essentials-security/Binary Introduction/Assembly Language/Reading/assembly-instructions">Assembly Instructions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/essentials-security/Binary Introduction/Assembly Language/Reading/dereferencing-addresses">Dereferencing Addresses</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/essentials-security/Binary Introduction/Assembly Language/Reading/reading-assembly">Reading Assembly</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/essentials-security/Binary Introduction/Assembly Language/Reading/summary">Summary</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/essentials-security/Binary Introduction/Assembly Language/Reading/further-reading">Further Reading</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/essentials-security/Binary Introduction/Assembly Language/Drills/">Drills</a><button aria-label="Toggle the collapsible sidebar category &#x27;Drills&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/essentials-security/Binary Introduction/Taming the Stack/">Taming the Stack</a><button aria-label="Toggle the collapsible sidebar category &#x27;Taming the Stack&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/essentials-security/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/essentials-security/Binary Introduction/"><span itemprop="name">Binary Introduction</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/essentials-security/Binary Introduction/Assembly Language/"><span itemprop="name">Assembly Language</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/essentials-security/Binary Introduction/Assembly Language/Reading/"><span itemprop="name">Reading</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Assembly Instructions</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Assembly Instructions</h1><p>We&#x27;ve now learned what assembly is theoretically and what registers are, but how do we use them?
Each CPU exposes an <strong>ISA (Instruction Set Architecture)</strong>: a set of instructions with which to modify and interact with its registers and with the RAM.
There are over 1000 instructions in the x64 ISA.
There are even instructions for efficiently encrypting data.
Find out more about them by enrolling in the <a href="https://github.com/security-summer-school/hardware-sec/" target="_blank" rel="noopener noreferrer">Hardware Assisted Security track</a>.</p><p>Before we dive into the instructions themselves, it&#x27;s useful to first look at their generic syntax:</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">instruction_name destination, source</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Most Assembly instructions have 2 operands: a source and a destination.
For some operations, such as arithmetic, the destination is also an operand.
The result of each instruction is always stored in the destination.</p><p>Below we&#x27;ll list some fundamental instructions.
We will be using the Intel Assembly syntax.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="mov"><code>mov</code><a class="hash-link" href="#mov" title="Direct link to heading">​</a></h2><p><code>mov</code> is the most basic instruction in Assembly.
It <em>copies</em> (or <em>moves</em>) data from the source to the destination.
Also note that comments in Assembly are preceded by <code>;</code> and that the language is case-insensitive.</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mov eax, 3              ; eax = 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov rbx, &quot;SSS Rulz&quot;     ; place the string &quot;SSS Rulz&quot; in `rbx`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; This places each byte of the string &quot;SSS Rulz&quot; in rbx.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mov r8b, bh             ; r8b = bh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; The sizes of the operands must be equal (1 byte each in this case).</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="data-manipulation">Data Manipulation<a class="hash-link" href="#data-manipulation" title="Direct link to heading">​</a></h2><p>Now that we&#x27;ve learnt how to place data in registers we need to learn how to do math with it.
As you&#x27;ve seen so far, Assembly instructions are really simple.
Below is a table with the most common and useful arithmetic instructions.
Try to figure out what each example does.
Use the fact that the general anatomy of an instruction is usually <code>instruction destination, source</code>.
The result is always stored in the <code>destination</code></p><table><thead><tr><th align="center">Instruction</th><th align="center">Description</th><th align="center">Examples</th></tr></thead><tbody><tr><td align="center"><code>add &lt;dest&gt;, &lt;src&gt;</code></td><td align="center"><code>dest += src</code></td><td align="center"><code>add rbx, 5</code><br><code>add r11, 0x99</code></td></tr><tr><td align="center"><code>sub &lt;dest&gt;, &lt;src&gt;</code></td><td align="center"><code>dest -= src</code></td><td align="center"><code>sub ecx, &#x27;a&#x27;</code><br><code>sub r9, r8</code></td></tr><tr><td align="center"><code>shl &lt;dest&gt;, &lt;bits&gt;</code></td><td align="center"><code>dest &lt;&lt;= bits</code></td><td align="center"><code>shl rax, 3</code><br><code>shl rdi, cl</code></td></tr><tr><td align="center"><code>shr &lt;dest&gt;, &lt;bits&gt;</code></td><td align="center"><code>dest &gt;&gt;= bits</code></td><td align="center"><code>shr r15, 5</code><br><code>shr rsi, cl</code></td></tr><tr><td align="center"><code>and &lt;dest&gt; &lt;src&gt;</code></td><td align="center"><code>dest &amp;= src</code></td><td align="center"><code>and al, ah</code><br><code>and bx, 13</code></td></tr><tr><td align="center"><code>or &lt;dest&gt; &lt;src&gt;</code></td><td align="center"><code>dest \|= src</code></td><td align="center"><code>or r10b, cl</code><br><code>or r14, 0x2000</code></td></tr><tr><td align="center"><code>xor &lt;dest&gt; &lt;src&gt;</code></td><td align="center"><code>dest ^= src</code></td><td align="center"><code>xor ebx, edx</code><br><code>xor rcx, 1</code></td></tr><tr><td align="center"><code>inc &lt;dest&gt;</code></td><td align="center"><code>dest++</code></td><td align="center"><code>inc rsi</code></td></tr><tr><td align="center"><code>dec &lt;dest&gt;</code></td><td align="center"><code>dest--</code></td><td align="center"><code>dec r10w</code></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="control-flow">Control Flow<a class="hash-link" href="#control-flow" title="Direct link to heading">​</a></h2><p>Now we know how to do maths and move bits around.
This is all good, but we still can&#x27;t write full programs.
We need a mechanism similar to <code>if</code>s from Python and also loops in order to make the code run based on conditions.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="jmp"><code>jmp</code><a class="hash-link" href="#jmp" title="Direct link to heading">​</a></h3><p>The simplest instruction for control flow is the <code>jmp</code> instruction.
It simply loads an address into the <code>rip</code> register.
But when Assembly code is generated or written either by the compiler or by us, instructions don&#x27;t have addresses yet.
These addresses are assigned during the <strong>linking</strong> or <strong>loading</strong> phase, as you know from the <a href="/essentials-security/Binary Introduction/Application Lifetime/">Application Lifetime session</a>.</p><p>For this reason, we use <strong>labels</strong> as some sort of anchors.
We <code>jmp</code> to them and then the assembler will replace them with relative addresses which are then replaced with full addresses during linking.
The way in which <code>jmp</code> and labels function is very simple.
Remember that in the absence of <code>jmp</code>s, Assembly code is executed linearly just like a script.</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    jmp skip_next_section</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ; Whatever code is here is never executed.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">skip_next_section:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ; Only the code below this label is executed.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p><strong>Warning</strong>
Do not confuse labels with functions.
A label does not stop the execution of code when it&#x27;s reached.
They are simply ignored by anything except for <code>jmp</code>.</p></blockquote><p>For example, in the following code, both instructions are executed in the absence of <code>jmp</code>s:</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    mov rax, 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">some_label:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mov rbx, 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ; rax = 2; rbx = 3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="eflags"><code>eflags</code><a class="hash-link" href="#eflags" title="Direct link to heading">​</a></h3><p>Each instruction (except for <code>mov</code>) changes the <strong>inner state of the CPU</strong>.
In other words, several aspects regarding the result of the instruction are stored in a special register that we cannot access directly, called <code>eflags</code>.
There are <a href="https://stackoverflow.com/questions/1406783/how-to-read-and-write-x86-flags-registers-directly" target="_blank" rel="noopener noreferrer">instructions</a> that can set or clear some flags in <code>eflags</code>, but we cannot write something like <code>mov eflags, 2</code>.</p><p>As its name implies, each bit in <code>eflags</code> is a flag that is activated (i.e. set to 1) if a certain condition is true about the result of the last executed instruction.
We won&#x27;t be using these flags per se with one exception: <code>ZF</code> - the <strong>zero flag</strong>.
When active, it means that the result of the last instruction was... 0, duh!
This is useful for testing if numbers are equal for example.
We&#x27;ll talk about this in the next section.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="conditional-jumps">Conditional jumps<a class="hash-link" href="#conditional-jumps" title="Direct link to heading">​</a></h3><p>Now we know that there is an internal state of the CPU which is modified by each instruction, except for <code>mov</code>.
We still need a way to leverage this state.
We can do this via <strong>conditional jumps</strong>.</p><p>They are like <code>jmp</code> instructions, but the jump is made only when certain conditions are met.
Otherwise, code execution continues from the next instruction.
The general syntax of a conditional jump is</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">j[n]&lt;cond&gt; label</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>where the letter <code>n</code> is optional and means the jump will be made if the condition is <strong>not</strong> met.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="cmp-and-test"><code>cmp</code> and <code>test</code><a class="hash-link" href="#cmp-and-test" title="Direct link to heading">​</a></h4><p>We can use the regular arithmetic instructions that we&#x27;ve learned so far to modify <code>eflags</code>.
But this has the drawback of also modifying our data.
It would be great if we had a means to modify <code>eflags</code> without changing the data that we evaluate.
We can do this using <code>cmp</code> and <code>test</code>.</p><p><code>cmp dest, src</code> modifies <code>eflags</code> as if you were <strong>subtracting</strong> <code>src</code> from <code>dst</code>, but without modifying <code>dst</code>.
This is great for testing if 2 things are equal, or for testing which is greater or lower.</p><p><code>test dest, src</code> is similar to <code>cmp</code>, but modifies <code>eflags</code> according to the <code>and</code> instruction.
This comes in handy when we want to check if a register is 0.</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">test rax, rax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jz rax_is_zero</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>is equivalent to</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cmp rax, 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jz rax_is_zero</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now let&#x27;s have a look at some conditional jumps:</p><table><thead><tr><th align="center">Conditional jump</th><th align="center">Meaning</th></tr></thead><tbody><tr><td align="center"><code>jz</code> / <code>je</code></td><td align="center">Jump if the Zero Flag is active</td></tr><tr><td align="center"><code>jnz</code> / <code>jne</code></td><td align="center">Jump if the Zero Flag is not active</td></tr><tr><td align="center"><code>cmp rax, rbx</code><br><code>j[n]g</code></td><td align="center">Jump if <code>rax</code> is (not) greater (signed) than <code>rbx</code></td></tr><tr><td align="center"><code>cmp rax, rbx</code><br><code>j[n]a</code></td><td align="center">Jump if <code>rax</code> is (not) greater (unsigned) than <code>rbx</code></td></tr><tr><td align="center"><code>cmp rax, rbx</code><br><code>j[n]ge</code></td><td align="center">Jump if <code>rax</code> is (not) greater (signed) or equal than <code>rbx</code></td></tr><tr><td align="center"><code>cmp rax, rbx</code><br><code>j[n]ae</code></td><td align="center">Jump if <code>rax</code> is (not) greater (unsigned) or equal than <code>rbx</code></td></tr><tr><td align="center"><code>cmp rax, rbx</code><br><code>j[n]l</code></td><td align="center">Jump if <code>rax</code> is (not) lower (signed) than <code>rbx</code></td></tr><tr><td align="center"><code>cmp rax, rbx</code><br><code>j[n]b</code></td><td align="center">Jump if <code>rax</code> is (not) lower (unsigned) than <code>rbx</code></td></tr><tr><td align="center"><code>cmp rax, rbx</code><br><code>j[n]le</code></td><td align="center">Jump if <code>rax</code> is (not) lower (signed) or equal than <code>rbx</code></td></tr><tr><td align="center"><code>cmp rax, rbx</code><br><code>j[n]be</code></td><td align="center">Jump if <code>rax</code> is (not) lower (unsigned) or equal than <code>rbx</code></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="loops">Loops<a class="hash-link" href="#loops" title="Direct link to heading">​</a></h3><p>We can create loops simply by combining labels and conditional jumps.
For example, <code>for i in range(0, 10)</code> from Python is equivalent to:</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    xor rcx, rcx    ; i = rcx; same as mov rcx, 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for_loop:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cmp rcx, 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    je done_loop    ; verify i &lt; 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ; The body of the for loop.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inc rcx         ; rcx++</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    jmp for_loop    ; re-evaluate the condition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">done_loop:</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Or alternatively, we can verify <code>rcx &lt; 10</code> at the end of the loop:</p><div class="language-asm codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-asm codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    xor rcx, rcx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for_loop:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ; The body of the for loop.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inc rcx         ; rcx++</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cmp rcx, 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    jb for_loop    ; verify i &lt; 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ; The code here is executed only after the loop ends.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/essentials-security/Binary Introduction/Assembly Language/Reading/registers"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Registers</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/essentials-security/Binary Introduction/Assembly Language/Reading/dereferencing-addresses"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Dereferencing Addresses</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#mov" class="table-of-contents__link toc-highlight"><code>mov</code></a></li><li><a href="#data-manipulation" class="table-of-contents__link toc-highlight">Data Manipulation</a></li><li><a href="#control-flow" class="table-of-contents__link toc-highlight">Control Flow</a><ul><li><a href="#jmp" class="table-of-contents__link toc-highlight"><code>jmp</code></a></li><li><a href="#eflags" class="table-of-contents__link toc-highlight"><code>eflags</code></a></li><li><a href="#conditional-jumps" class="table-of-contents__link toc-highlight">Conditional jumps</a></li><li><a href="#loops" class="table-of-contents__link toc-highlight">Loops</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://security.cs.pub.ro/summer-school/wiki/" target="_blank" rel="noopener noreferrer" class="footer__link-item">OCW<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.facebook.com/SSSUPB/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 SSS Team</div></div></div></footer></div>
<script src="/essentials-security/assets/js/runtime~main.6243ae71.js"></script>
<script src="/essentials-security/assets/js/main.26f79083.js"></script>
</body>
</html>